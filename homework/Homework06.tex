\documentclass[11pt]{exam}

\usepackage{amssymb, amsmath, amsthm, mathrsfs, multicol, graphicx} 
\usepackage{tikz}

\input{../macros-discrete}

\def\circleA{(-.5,0) circle (1)}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\circleB{(.5,0) circle (1)}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\circleC{(0,-1) circle (1)}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\twosetbox{(-2,-1.5) rectangle (2,1.5)}
\def\threesetbox{(-2,-2.5) rectangle (2,1.5)}

%\pointname{pts}
\pointsinmargin
\marginpointname{pts}
\addpoints
\pagestyle{head}
%\printanswers

\firstpageheader{Math 228}{\bf Homework 6}{Due: Wednesday, March 4}


\begin{document}
\noindent \textbf{Instructions}: Same rules as usual - turn in your work on separate sheets of paper.  You must justify all your answers for full credit.

\begin{questions}

\question[6] Consider the sequence $5, 11, 19, 29, 41, 55,\ldots$.  Assume $a_1 = 5$.
\begin{parts}
\part Find a closed formula for $a_n$, the $n$th term of the sequence, by writing each term as a sum of a sequence.  Hint: first find $a_0$, but ignore it when collapsing the sum.
\begin{solution}
$a_0 = 1$, $a_1 = 1+4$, $a_2 = 1+4+6$, $a_3 = 1+4+6+8$ and so on.  If we ignore (for the moment) the 1, we have the sum of an arithmetic sequence.  So
\begin{align*}
a_n & = 1 + [4 + 6 + 8 + 10 + \cdots + (2n) + (2+2n)]\\
+ a_n & = 1 + [(2+2n) + (2n) + \cdots +  8 + 6 + 4] \\ \hline
2a_n & = 1 + n(2n+6)
\end{align*}

So $a_n = \frac{1+n(2n+6)}{2}$
\end{solution}


\part Find a closed formula again, this time using either polynomial fitting or the characteristic root technique (whichever is appropriate).  Show your work.

\begin{solution}
The sequence of first differences is $4, 6, 8, 10, 12,\ldots$, so the sequence of second differences is $2, 2, 2,\ldots$ which is constant.  Thus we know that the original sequence will be a quadratic: $a_n = an^2 + bn + c$.  We know $a_0 = 1$ so we have $c = 1$.  This gives the system
\[5 = a + b + 1\]
\[11 = 4a + 2 b + 1\]
If we multiply the first equation by $-2$ and add the second equation we get $1 = 2a - 1$ so $a = 1$.  Plugging this into the first equation gives $b = 3$.  Thus the closed formula is $a_n = n^2 + 3n + 1$.
\end{solution}

\part Find a closed formula once again, this time by recognizing the sequence as a modification to some well known sequence(s).  Explain.
\begin{solution}
If we compare our sequence to the sequence of squares $1,4,9, 16, 25,\ldots$ we see a difference of $4, 7, 10, 13, 16, \ldots$.  These are each 1 more than a multiple of 3.  So we see that the sequence $5, 11, 19, 29, 41, 55,\ldots$ is just the sequence of squares plus the sequence given by $3n+1$.  So
\[a_n = n^2 + 3n + 1\]

\end{solution}

\end{parts}


\question In their down time, ghost pirates enjoy stacking cannonballs in triangular based pyramids (aka, tetrahedrons), like those pictured here:

\centerline{\includegraphics[height=1in]{images/cannonballs.png}}

Note, in the picture on the right, there are some cannonballs (actually just one) you cannot see. The next picture would have 4 cannonballs you cannot see. 

The pirates wonder how many cannonballs would be required to build a pyramid 15 layers high (thus breaking the world cannonball stacking record).  Can you help?

\begin{parts}
\part[2] Let $P(n)$ denote the number of cannonballs needed to create a pyramid $n$ layers high.  So $P(1) = 1$, $P(2) = 4$, and so on.  Calculate $P(3)$, $P(4)$ and $P(5)$.
\begin{solution}
  To get the next larger pyramid, we add a triangle of cannonballs to the previous pyramid.  Thus to get $P(n)$, we add $P(n-1)$ to the $n$th triangular number:
  $P(3) = 4 + 6 = 10$, $P(4) = 10 + 10 = 20$, $P(5) = 20 + 15 = 35$.
\end{solution}


\part[4] Use polynomial fitting to find a closed formula for $P(n)$.  Show your work.
\begin{solution}
  The first differences are $3, 6, 10, 15, \ldots$.  The second differences are $3, 4, 5, 6, \ldots$.  The third differences are $1,1,1,\ldots$.  Since third differences are constant, we know the closed formula for $P(n)$ will be a degree 3 polynomial.  So $P(n) = an^3 + b n^2 + cn + d$.  Note that $P(0) = 0$, so $d = 0$.  To solve for $a$, $b$, and $c$, we solve the system of equations:
  \begin{align*}
    1 & = a + b + c \\
    4 & = 8a+ 4b + 2c \\
    10 & = 27a + 9b + 3c
  \end{align*}
  Doing so gives $a = \frac{1}{6}$, $b = \frac{1}{2}$ and $c = \frac{1}{3}$ so 
  \[P(n) = \frac{1}{6}n^3 + \frac{1}{2} n^2 + \frac{1}{3} n\]
\end{solution}


\part[2] Answer the pirate's question: how many cannonballs do they need to make a pyramid 15 layers high?

\begin{solution}
  \[P(15) = \frac{1}{6}15^3 + \frac{1}{2} 15^2 + \frac{1}{3} 15 = 680\]
\end{solution}

\end{parts}


\question[8] Consider the sequences $2, 5, 12, 29, 70, 169, 408,\ldots$ (with $a_0 = 2$).  
\begin{parts}
\part Describe the rate of growth of this sequence.
\begin{solution}
It does not seem to help to look at the difference between terms - in fact, the differences seem to be growing in the same manner as the original sequence.  However, looking at the ratio between terms gives us almost a common ratio of 2.  In other words, it appears that the sequence is growing exponentially.
\end{solution}


\part Find a recursive definition for the sequence.
\begin{solution}
We see that $5$ is a little more than twice the previous term, and 12 is a little more than twice 5.  In fact, it is exactly 2 more, which is the first term.  So perhaps $a_n = 2a_{n-1} + a_{n-2}$, and this seems to work moving forward.
\end{solution}

\part Find a closed formula for the sequence.

\begin{solution}
Use the characteristic root technique.  The characteristic equation is $x^2 - 2x - 1 = 0$.  Solving this (using the quadratic formula) gives $x = 1\pm\sqrt{2}$.  So we know that the closed formula for $a_n = a(1+\sqrt{2})^n + b(1-\sqrt{2})^n$.  Now let's find $a$ and $b$.  We have

\[2 = a + b\]
\[5 = a(1+\sqrt{2}) + b(1-\sqrt{2})\]
Use substitution: $a = 2-b$ so $5 = (2-b)(1+\sqrt 2) + b(1-\sqrt{2})$ which simplifies to $b = \frac{3\sqrt{2} - 4}{4}$.  This gives $a = \frac{4 - 3\sqrt 2}{4}$.  Therefore
\[a_n = \frac{4-3\sqrt{2}}{4}(1+\sqrt{2})^n + \frac{3\sqrt{2} - 4}{4}(1-\sqrt{2})^n\]
\end{solution}

\part If you look at the sequence of differences between terms, and then the sequence of second differences, the sequence of third differences, and so on, will you ever get a constant sequence?  Explain how you know.
\begin{solution}
You will never get a constant sequence of differences.  If you did, this would mean that the original sequence would be some polynomial.  But we have an exponential closed formula, so no polynomial will fit.
\end{solution}
\end{parts}


\question Let $a_n$ be the number of  $1 \times n$ tile designs can you make using $1 \times 1$ squares available in 4 colors and $1 \times 2$ dominoes available in 5 colors.
\begin{parts}
  \part[3] First, find a recurrence relation to describe the problem.  Explain why the recurrence relation is correct (in the context of the problem).
  \begin{solution}
    $a_n = 4a_{n-1} + 5a_{n-2}$.  Each path of length $n$ must either start with one of the 4 $1\times 1$ tiles, in each case there are then $a_{n-1}$ ways to finish the path, or start with one of the 5 $1\times 2$ tiles, in each case there are then $a_{n-2}$ ways to finish the path.
  \end{solution}

  \part[2] Write out the first 6 terms of the sequence $a_1, a_2, \ldots$.
  \begin{solution}
    4, 21, 104, 521, 2604, 13021
  \end{solution}

  \part[3] Solve the recurrence relation.  That is, find a closed formula for $a_n$.
  \begin{solution}
    The characteristic equation is $x^2 - 4x - 5 = 0$ so the characteristic roots are $x = 5$ and $x = -1$.  Therefore the general solution is 
    \[a_n = a 5^n + b (-1)^n\]
    We solve for $a$ and $b$ using the fact that $a_1 = 4$ and $a_2 = 21$.  We get $a = \frac{5}{6}$ and $b = \frac{1}{6}$.  Therefore the solution is
    \[a_n = \frac{5}{6} 5^n + \frac{1}{6}(-1)^n\]
  \end{solution}

\end{parts}






%\question[6] Consider the recurrence relation $a_n = 4a_{n-1} - 4a_{n-2}$.
%\begin{parts}
%  \part Find the general solution to the recurrence relation (beware the repeated root).
%  \begin{solution}
%    The characteristic polynomial is $x^2 - 4x + 4$ which factors as $(x -2)^2$, so the only characteristic root is $x = 2$.  Thus the general solution is
%    \[a_n = a2^n + bn2^n\]
%  \end{solution}
%
%  \part Find the solution when $a_0 = 1$ and $a_1 = 2$.
%  \begin{solution}
%    Since $1 = a2^0 + b\cdot 0 \cdot 2^0$ have have $a = 1$.  Then $2 = 2^1 + b 2^1$ so $b = 0$.  We have the solution 
%    \[a_n = 2^n\]
%  \end{solution}
%
%  \part Find the solution when $a_0 = 1$ and $a_1 = 8$.
%  \begin{solution}
%    Again, we have $a = 1$.  Now when we plug in $n = 1$ we bet $8 = 2 + 2b$ so $b = 3$.  The solution:
%    \[a_n = 2^n + 3n2^n\]
%  \end{solution}
%
%\end{parts}



\end{questions}
\end{document}


