<?xml version="1.0" encoding="UTF-8"?>
<exercises xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="exercises_seq_basics">

<!-- Add webwork exercises: -->
<!-- Find a_5 for some closed formulas and for some recursive formulas -->
<!-- Say whether a formula is a closed formula or a recurrence relation -->
<!-- Which recurrence relations agree with the sequence? -->
<!-- Are there two different sequences that have the same closed formula, recurrence relation, or recursive definition? -->
<!-- Something about the difference between the value and index -->

    <exercise>
      <webwork>
        <setup>
          <pg-code>
            Context()->variables->are(n => "Real");
            $ans1 = Formula("n^2 + 1");
            $ans2 = Formula("(n*(n-1))/2 - 1");
            $ans3 = Formula("((n+2)*(n+3))/2 + 2");
            $ans4 = Formula("(n+1)! - 1");
          </pg-code>
        </setup>
        <statement>
          <p>
            Find the closed formula for each of the following sequences by relating them to a well known sequence. Assume the first term given is <m>a_1</m>.
          </p>

          <ol>
            <li>
              <p><m>2, 5, 10, 17, 26, \ldots</m></p>
              <instruction>
                <m>a_n = </m> <var name="$ans1" width="10"/>
              </instruction>
            </li>
            <li>
              <p><m>0, 2, 5, 9, 14, 20, \ldots</m></p>
              <instruction>
                <m>a_n = </m> <var name="$ans2" width="10"/>
              </instruction>
            </li>
            <li>
              <p><m>8, 12, 17, 23, 30,\ldots</m></p>
              <instruction>
                <m>a_n = </m> <var name="$ans3" width="10"/>
              </instruction>
            </li>
            <li>
              <p><m>1, 5, 23, 119, 719,\ldots</m></p>
              <instruction>
                <m>a_n = </m> <var name="$ans4" width="10"/>
              </instruction>
            </li>
          </ol>
        </statement>
        <solution>
          <p>
            <ol>
              <li>Note that if we subtract 1 from each term, we get the familiar triangular numbers.  Thus <m>a_n = n^2 + 1</m>.</li>
              <li>These look like the triangular numbers, only shifted by 1.  We get: <m>a_n = \frac{n(n+1)}{2} - 1</m>.</li>
              <li>If you subtract 2 from each term, you get triangular numbers, only starting with 6 instead of 1.  So we must shift vertically and horizontally.  <m>a_n = \frac{(n+2)(n+3)}{2} + 2</m>.</li>
              <li>These seem to grow very quickly.  Further, if we add 1 to each term, we find the factorials, although starting with 2 instead of 1.  This gives, <m>a_n = (n+1)! - 1</m> (where <m>n! = 1 \cdot 2 \cdot 3 \cdots n</m>).</li>
            </ol>
          </p>
        </solution>
      </webwork>
    </exercise>



    <exercise>
      <webwork>
        <setup>
          <pg-code>
            Context()->variables->are(n => "Real");
            $ans1 = Formula("2^n + 3");
            $ans2 = Formula("(n+1)^2 - 1");
            $ans3 = Formula("(n+2)(n+3)");
            $ans4 = Formula("(n*(n+1))/2 + n^2");
          </pg-code>
        </setup>
        <statement>
          <p>
            For each sequence given below, find a closed formula for <m>a_n</m>, the <m>n</m>th term of the sequence (assume the first terms are <m>a_0</m>) by relating it to another sequence for which you already know the formula. In each case, briefly say how you got your answers.

          <ol>
            <li>
              <p>
                4, 5, 7, 11, 19, 35, <ellipsis/>
              </p>
              <instruction>
                <m>a_n = </m> <var name="$ans1" width="10"/>
              </instruction>
            </li>
            <li>
              <p>
                0, 3, 8, 15, 24, 35, <ellipsis/>
              </p>
              <instruction>
                <m>a_n = </m> <var name="$ans2" width="10"/>
              </instruction>
            </li>
            <li>
              <p>
                6, 12, 20, 30, 42, <ellipsis/>
              </p>
              <instruction>
                <m>a_n = </m> <var name="$ans3" width="10"/>
              </instruction>
            </li>
            <li>
              <p>
                0, 2, 7, 15, 26, 40, 57, <ellipsis/> (Cryptic Hint: these might be called <q>house numbers</q>)
              </p>
              <instruction>
                <m>a_n = </m> <var name="$ans4" width="10"/>
              </instruction>
            </li>
          </ol>
        </p>
        </statement>
        <solution>
          <p>
            <ol>
              <li>
                <p>
                      If we subtract 3 from each term, we get <m>1, 2, 4, 8, 16, 32, \ldots</m>, which are the powers of 2. So we must shift this sequence up by 3 to get our sequence. Thus
                      <me>
                        a_n = 2^n + 3
                      </me>
                </p>
              </li>
              <li>
                    <p>
                      Add 1 to each term - we get <m>1, 4, 9, 16, 25, 36, \ldots</m>, the square numbers. So maybe our sequence as formula <m>a_n = n^2 - 1</m>. Does this work? <m>a_3 = 8</m>. That is a term of our sequence, but it should be <m>a_2</m>. So we want
                      <me>
                        a_n = (n+1)^2 - 1
                      </me>
                </p>
              </li>
              <li>
                    <p>
                      Each term is even, so let's see what happens when we divide by 2: we get <m>3, 6, 10, 15, 21,\ldots</m>. These are the triangle numbers, but starting at <m>T_2</m>. We know <m>T_n = \frac{n(n+1)}{2}</m>. We want <m>a_0 = 2T_2</m>, <m>a_1 = 2T_3</m>, and so on. In general, <m>a_n = 2T_{n+2}</m>, so
                      <me>
                        a_n = (n+2)(n+3)
                      </me>
                    </p>

                    <p>
                      (This is like a shift by 2 units to the left and a stretch by a factor of 2.)
                </p>
              </li>
              <li>
                <p>
                      How far off from triangular number are these? The triangular numbers (starting with <m>T_0</m>) are <m>0, 1, 3, 6, 10, 15, 21, \ldots</m>. The given sequence differs from this by <m>0, 1, 4, 9, 16, 25, 36, \ldots</m> the square numbers! Thus
                      <me>
                        a_n = \frac{n(n+1)}{2} + n^2
                      </me>
                </p>
              </li>
            </ol>
          </p>
        </solution>
      </webwork>
    </exercise>



    <exercise>
      <statement>
        <p>
          Write out the first 5 terms (starting with <m>a_0</m> ) of each of the sequences described below.  Then give either a closed formula or a recursive definition for the sequence (whichever is NOT given in the problem).
          <ol>
            <li>
              <p>
                <m>a_n = \frac{1}{2}(n^2 + n)</m> .
              </p>
            </li>

            <li>
              <p>
                <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_0 = 0</m> and <m>a_1 = 1</m> .
              </p>
            </li>

            <li>
              <p>
                <m>a_n = na_{n-1}</m> with <m>a_0 = 1</m> .
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <solution>
        <p>
          <ol>
            <li>
              <p>
                <m>a_0 = 0</m> , <m>a_1 = 1</m> , <m>a_2 = 3</m> , <m>a_3 = 6</m>  <m>a_4 = 10</m> . The sequence was described by a closed formula.  These are the triangular numbers.  A recursive definition is: <m>a_n = a_{n-1} + n</m> with <m>a_0 = 0</m> .
              </p>
            </li>

            <li>
              <p>
                This is a recursive definition.  We continue <m>a_2 = 2</m> , <m>a_3 = 3</m> , <m>a_4 = 4</m> , <m>a_5 = 5</m> , and so on.  A closed formula is <m>a_n = n</m> .
              </p>
            </li>

            <li>
              <p>
                We have <m>a_0 = 1</m> , <m>a_1 = 1</m> , <m>a_2 = 2</m> , <m>a_3 = 6</m> , <m>a_4 = 24</m> , <m>a_5 = 120</m> , and so on.  The closed formula is <m>a_n = n!</m> .
              </p>
            </li>
          </ol>
        </p>
      </solution>
    </exercise>



    <exercise>
      <statement>
        <p>
          The Fibonacci sequence is <m>0, 1, 1, 2, 3, 5, 8, 13, \ldots</m> (where <m>F_0 = 0</m>).<idx><h>Fibonacci sequence</h></idx>
        </p>

        <p>
          <ol>
            <li>
              <p>
                Give the recursive definition for the sequence.
              </p>
            </li>
            <li>
              <p>
                Write out the first few terms of the sequence of partial sums: <m>0</m>, <m>0+1</m>, <m>0+1+1</m>,<ellipsis/>
              </p>
            </li>
            <li>
              <p>
                Give a closed formula for the sequence of partial sums in terms of <m>F_n</m><notation><usage>F_n</usage><description>the <m>n</m>th Fibonacci number</description></notation> (for example, you might say <m>F_0 + F_1 + \cdots + F_n = 3F_{n-1}^2 + n</m>, although that is definitely not correct).
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <solution>
        <p>
          <ol>
            <li><m>F_n = F_{n-1} + F_{n-2}</m> with <m>F_0 = 0</m> and <m>F_1 = 1</m>.</li>
            <li><m>0, 1, 2, 4, 7, 12, 20, \ldots.</m></li>
            <li><m>F_0 + F_1 + \cdots + F_n = F_{n+2} - 1.</m></li>
          </ol>
        </p>
      </solution>
    </exercise>

    <exercise>
      <statement>
        <p>
          Consider the three sequences below. For each, find a recursive definition. How are these sequences related?
        </p>

        <p>
          <ol>
            <li><m>2, 4, 6, 10, 16, 26, 42, \ldots</m>.</li>
            <li><m>5, 6, 11, 17, 28, 45, 73, \ldots</m>.</li>
            <li><m>0, 0 , 0 , 0 , 0 , 0 , 0 ,\ldots</m>.</li>
          </ol>
        </p>
      </statement>
      <solution>
        <p>
          The sequences all have the same recurrence relation: <m>a_n = a_{n-1} + a_{n-2}</m> (the same as the Fibonacci numbers). The only difference is the initial conditions.
        </p>
      </solution>
    </exercise>



    <exercise>
      <statement>
        <p>
          Show that <m>a_n = 3\cdot 2^n + 7\cdot 5^n</m> is a solution to the recurrence relation <m>a_n = 7a_{n-1} - 10a_{n-2}</m>.   What would the initial conditions need to be for this to be the closed formula for the sequence?
        </p>
      </statement>
    </exercise>



    <exercise>
      <statement>
        <p>
          Write out the first few terms of the sequence given by <m>a_1 = 3</m>; <m>a_n = 2a_{n-1} + 4</m>. Then find a recursive definition for the sequence <m>10, 24, 52, 108, \ldots</m>.
        </p>
      </statement>
      <!-- <solution>
        <p>
          <m>3, 10, 24, 52, 108,\ldots</m>. The recursive definition for <m>10, 24, 52, \ldots</m> is <m>a_n = 2a_{n-1} + 4</m> with <m>a_1 = 10</m>.
        </p>
      </solution> -->
    </exercise>

    <exercise>
      <statement>
        <p>
          Write out the first few terms of the sequence given by <m>a_n = n^2 - 3n + 1</m>. Then find a closed formula for the sequence (starting with <m>a_1</m>) <m>0, 2, 6, 12, 20, \ldots</m>.
        </p>
      </statement>
      <!-- <solution>
        <p>
          <m>-1, -1, 1, 5, 11, 19,\ldots</m> Thus the sequence <m>0, 2, 6, 12, 20,\ldots</m> has closed formula <m>a_n = (n+1)^2 - 3(n+1) + 2</m>.
        </p>
      </solution> -->
    </exercise>

    <exercise>
      <statement>
        <p>
          Find a closed formula for the sequence with recursive definition <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_1 = 1</m> and <m>a_2 = 2</m>.
        </p>
      </statement>
      <!-- <solution>
        <p>
          Write out the first few terms of the sequence: <m>1, 2, 3, 4, 5, 6,\ldots</m>. This is surprising at first, but note that we could write <m>2a_{n-1} - a_{n-2} = a_{n-1} + (a_{n-1} -a_{n-2})</m>, and <m>a_{n-1} - a_{n-2}</m> is just the difference between the terms. Initially, the difference between terms is 1, so each time we are just adding one. So we see that <m>a_n = n</m> is the closed formula.
        </p>
      </solution> -->
    </exercise>

    <exercise>
      <statement>
        <p>
          Find a recursive definition for the sequence with closed formula <m>a_n = 3 + 2n</m>. Bonus points if you can give a recursive definition in which makes use of two previous terms and no constants.
        </p>
      </statement>
      <!-- <solution>
        <p>
          The sequence we get is <m>3, 5, 7, 9, \ldots</m>. One recursive definition for this is <m>a_n = a_{n-1} + 2</m> with <m>a_0 = 3</m>. Another option would be to take <m>a_n = 2a_{n-1} - a_{n-2}</m> with <m>a_0 = 3</m> and <m>a_1 = 5</m>.
        </p>
      </solution> -->
    </exercise>


    <exercise>
      <statement>
        <p>
          Consider bit strings with length <m>l</m> and weight <m>k</m> (so strings of <m>l</m> 0's and 1's, including <m>k</m> 1's).  We know how to count the number of these for a fixed <m>l</m> and <m>k</m>.  Now, we will count the number of strings for which the <em>sum</em> of the length and the weight is fixed.  For example, let's count all the bit strings for which <m>l+k = 11</m>.
          <ol>
            <li>
              <p>
                Find examples of these strings of different lengths.  What is the longest string possible?  What is the shortest?
              </p>
            </li>

            <li>
              <p>
                How many strings are there of each of these lengths.  Use this to count the total number of strings (with sum 11).
              </p>
            </li>

            <li>
              <p>
                The other approach: Let <m>n = l+p</m> vary.  How many strings have sum <m>n = 1</m>?  How many have sum <m>n = 2</m>?  And so on.  Find and explain a recurrence relation for the sequence <m>(a_n)</m> which gives the number of strings with sum <m>n</m>.
              </p>
            </li>

            <li>
              <p>
                Describe what you have found above in terms of Pascal's Triangle.  What pattern have you discovered?
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <solution category="instructor">
        <p>
          <ol>
            <li>
              <p>
                The longest string is 00000000000.  If we insert a 1, we need to replace two 0's, which shortens the string.  The more 1's, the shorter the string.  We could have 111110, or 101111, or others like this (there will be 6 of them) which are shortest possible.  So all strings range in length between 6 and 11.
              </p>
            </li>

            <li>
              <p>
                There is 1 string with length 11.  To get a string with length 10, we need one of the 10 spots to be a 1.  Thus there are 10 of these.  To get a string of length 9, we need exactly 2 of the 9 spots to be 1's, so there are <m>{9 \choose 2} = 36</m> such strings.  There will be <m>{8 \choose 3} = 56</m> strings with length 8, another <m>{7 \choose 4} = 35</m> of length 7, and finally <m>{6 \choose 5} = 6</m> of length 6.  All together we have
                <me>
                  1 + 10 + 36 + 56 + 35 + 6 = 144 \text{ strings}
                </me>
              </p>
            </li>

            <li>
              <p>
                There is 1 string with sum <m>n = 1</m> (just the string 1).  There are two strings with sum <m>n = 2</m> (namely 11, 2).  With sum <m>n = 3</m> we get 3 strings (111, 12, 21), and 5 with sum <m>n = 4</m>.  In fact, we recognize these as the Fibonacci numbers, which satisfy the recurrence <m>f_n = f_{n-1} + f_{n-2}</m> with initial condition here <m>f_1 = 1</m> and <m>f_2 = 2</m>.  The reason this is correct is that to get all the strings with sum <m>n</m>, we can start with a 1 and finish with any string with sum <m>n-1</m>, or start with a 2 and finish with any string with sum <m>n - 2</m>.  If we carry out this recurrence we find <m>f_{11} = 144</m>.
              </p>
            </li>

            <li>
              <p>
                In this one specific case we have that
                <me>
                  {11\choose 0} + {10 \choose 1} + {9 \choose 2} + {8 \choose 3} + {7 \choose 4} + {6 \choose 5} = f_{11}
                </me>
                On Pascal's triangle, we recognize that this is the sum of a diagonal line of cells (moving right, then right-up each time).  Indeed, every such sum of diagonals gives a Fibonacci number.
              </p>
            </li>
          </ol>
        </p>
      </solution>
    </exercise>

    <exercise>
      <statement>
        <p>
          Bonus:  When bees play chess, they use a hexagonal board like the one shown below.  The queen bee can move one space at a time either directly to the right or angled up-right or down-right (but can never move leftwards).  How many different paths can the queen take from the top left hexagon to the bottom right hexagon?  Explain your answer, and this relates to the previous question.  (As an example, there are three paths to get to the second hexagon on the bottom row.)
        </p>

          <sidebyside width="70%">
            <image xml:id="bee-chess">
              <latex-image>
                \def\r{1}
                \newcommand{\hexagon}[3]{
                  \def\x{-cos{30}*\r*#1+cos{30}*#2*\r*2}
                  \def\y{-\r*#1-sin{30}*\r*#1}
                  \draw[thick] (\x,\y) +(90:\r) -- +(30:\r) -- +(-30:\r) -- +(-90:\r) -- +(-150:\r) -- +(150:\r) -- cycle;
                  \draw (\x,\y) node{#3};
                }
                \begin{tikzpicture}[scale=.75]
                \hexagon{1}{0}{\tiny start};
                \hexagon{2}{2}{3}
                \foreach \i in {1,...,5} {
                  \foreach \j in {1,2} {
                    \hexagon{\j}{\i}{};
                  }
                }
                \hexagon{2}{6}{\tiny stop};
                \end{tikzpicture}
              </latex-image>
            </image>

          </sidebyside>
        </statement>
        <solution category="instructor">
          <p>
            We can code each path through the hive using 0's and 1's as follows:  A 0 corresponds to a move up-right or down-right, a 1 corresponds to a move directly to the right.  Notice that a 1 move can be replaced by two consecutive 0 moves.  This describes a bijection between strings of 0's and 1's with total sum of length and weight equal to 11 and paths through the hive, so there are 144 paths.
          </p>
        </solution>
      </exercise>

  </exercises>
